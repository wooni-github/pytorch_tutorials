# 파이토치 텐서 기본 사용법

예제코드 [pytorch_tutorials/1.Tensors/tensor_operations.py](https://github.com/wooni-github/pytorch_tutorials/blob/main/1.Tensors/tensor_operations.py)

파이토치에서 사용하는 텐서의 기본적인 연산에 관한 내용입니다.

## 1. 텐서 생성

```python
print(  torch.empty(5, 4) )
print(  torch.ones(3, 3)  )
print(  torch.zeros(2)  )
print(  torch.rand(3, 5)  )
```

코드|내용
---|---|
**torch.empty(5, 4)** | [5x4] 크기의 임의의 값으로 초기화 된 텐서 생성 |
**torch.ones(3, 3)** | [3x3] 크기의 1.0으로 초기화 된 텐서 생성 |
**torch.zeros(2)** | [2] 크기의 0.0으로 초기화 된 텐서 생성 |
**torch.rand(3, 5)** | [0~1]사이의 임의의 값으로 초기화 된  [3x5]크기의 텐서 생성|


## 2. 텐서 변환




```python
l1 = [1, 2, 3] # list
l2 = np.array([4, 5, 6]) # numpy array
print(  torch.tensor(l1)  )
print(  torch.tensor(l2)  )
print(  torch.tensor(l2, dtype=torch.float32) )

l3 = [[1, 2], [3, 4], [5, 6]]
print(  torch.tensor(l3).size() )
print(  type(torch.tensor(l3))  )
```

코드|내용
---|---|
**torch.tensor(l1)**| 파이썬 리스트 혹은 numpy 배열로부터 텐서 생성
**torch.tensor(l2, dtype=torch.float32)**|타입을 지정한 텐서 생성
**torch.tensor(l3).size()**|텐서 크기 반환
**type(torch.tensor(l3))**|텐서 타입 반환

**코드를 직접 작성할 때, 형변환에 주의할것!!**


## 3. 텐서 연산 (곱, 행렬곱, 합)

```python
x = torch.rand(4, 4)
y = torch.rand(4, 4)

# 요소별 곱
print(  x*y )
print(  x.numpy()*y.numpy() )

# 행렬곱
print(  torch.matmul(x, y)  )
print(  np.matmul(x.numpy(), y.numpy()) )
```

코드|내용
---|---|
**x * y**|요소별 곱 반환
**x.numpy() * y.numpy()**|요소별 곱 numpy에서 계산 후 반환
**torch.matmul(x, y)**|행렬곱 반환
**np.matmul(x.numpy(), y.numpy())**|행렬곱 numpy에서 계산 후 반환


```python
print(  x + y ) # x + y 반환
print(  torch.add(x, y) ) # x + y 반환
print(  y.add(x)  ) # x + y 반환
print(  y ) # y는 변하지 않음

print(  y.add_(x) ) # y = x + y 반환
print(  y ) # y가 변함
```

코드|내용
---|---|
**x+y**| x + y 반환
**torch.add(x, y)**| x + y 반환
**y.add(x)**| x + y 반환
**y.add_(x)**| y = x + y 반환 **(y가 변경됨)**


## 4. 텐서 값 접근 및 변경

```python
print(  y[0, 0] )
print(  y[0, 0].numpy() )
z = torch.Tensor([1])
print(  z.item()  )
# print(  y.item()  )
y[0, 0] = 4.44
print(y[0, 0]) # 4.44
```

코드|내용
---|---|
**y[0, 0]**|텐서 y의 [0, 0]에 접근
**y[0, 0].numpy()**|텐서 y의 [0, 0]에 접근하여 값을 numpy로 반환
**z.item()**|텐서 z 스칼라 값 반환 **단독 값으로 구성된 스칼라 텐서만 item() 사용 가능**
**y[0, 0]=4.44**|텐서의 값 변경


